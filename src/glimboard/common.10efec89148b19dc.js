"use strict";(self.webpackChunkGlimBoard=self.webpackChunkGlimBoard||[]).push([[592],{4386:(p,h,i)=>{i.d(h,{s:()=>d});var l=i(5861),c=i(1571);let u=(()=>{class n{constructor(){this.url=localStorage.getItem("url")||"ws://localhost:3001"}get(t,r,e){return localStorage.getItem(t)||(e&&localStorage.setItem(t,r),r)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),d=(()=>{class n{constructor(t){this.configService=t,this.publicisConnected=!1,this.emitter=new c.vpe}connect(){return new Promise(t=>{this.ws=new WebSocket(this.configService.get("url","http://localhost:4201/api/",!1)),this.ws.onopen=r=>{t(!0),this.onConnect(r)},this.ws.onmessage=r=>this.onMessage(JSON.parse(r.data)),this.ws.onclose=r=>this.onClose(r.reason,r.code),console.log("Listeners set, all good"),t(!0)})}onConnect(t){console.log("Connected to the api",t)}onMessage(t){console.log(t),this.emitter.emit(t)}onClose(t,r){console.log("Connection closed",t,r)}send(t){this.ws.send(JSON.stringify(t))}awaitResponse(t,r){return new Promise(e=>{this.ws.send(JSON.stringify(t)),this.emitter.subscribe(o=>{console.log(o),o.ID==r&&e(o)})})}sendHTTPRequest(t,r,e={}){var o=this;return(0,l.Z)(function*(){try{let s=o.configService.get("url","http://localhost:4201/api/",!1),f=yield fetch(s+t,{method:r,body:o.getCheck(r,e)}),g=yield f.json();return console.log(g,f.status),{status:f.status,result:g}}catch(s){return console.log(s),{status:1,result:null}}})()}getCheck(t,r){if("GET"!=t)return JSON.stringify(r)}}return n.\u0275fac=function(t){return new(t||n)(c.LFG(u))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},5842:(p,h,i)=>{i.d(h,{$:()=>a});var l=i(5861);let c={name:"Default Board",description:"The default board created",id:0,columns:12,rowHeight:25,squish:null,buttons:[{dimensions:{height:5,width:5,positionX:1,positionY:1},h:5,w:5,id:"0",instructions:[{action:"Message",data:{message:"Hello world from default button!"}}],name:"Default Button",x:1,y:1,img:null}]};var u=i(1571),d=i(4386),n=i(8010);let a=(()=>{class t{constructor(e,o){this.apiService=e,this.notification=o,this.config={columns:12,rowHeight:25,squish:null},this.allBoards=[],this.getBoards()}getBoards(){var e=this;return(0,l.Z)(function*(){let o=yield e.apiService.sendHTTPRequest("boards","GET",{});if(console.log(o),o.result){if(0==o.result.length){console.log("Recieved boards but none exist.");let s=e.notification.open("No boards were found. Creating a default one...","Close",{panelClass:["bg-blue-400"],duration:7e3});setTimeout(()=>{e.createDefaultBoard(),s.dismiss()},4e3)}e.allBoards=o.result}else e.notification.open("Failed to retrieve board information.","Close",{panelClass:["bg-red-400"],duration:7e3});return o.result||[]})()}get boards(){return this.boards}get activeBoard(){return this.allBoards[0]}get getConfig(){return this.config}setConfig(e){this.config=e}removeBoard(e){var o=this;return(0,l.Z)(function*(){let s=yield o.apiService.sendHTTPRequest("boards","DELETE",{id:e});s.result&&1==s.result.removed?(o.notification.open("Board deleted.","Close",{panelClass:["bg-green-400"],duration:7e3}),o.allBoards=o.allBoards.filter((f,g)=>f.id!=e)):o.notification.open("Failed to delete board.","Close",{panelClass:["bg-red-400"],duration:7e3})})()}updateBoard(){var e=this;return(0,l.Z)(function*(){null==(yield e.apiService.sendHTTPRequest("boards","PATCH",e.activeBoard)).result&&e.notification.open("Failed to update board.","Close",{panelClass:["bg-red-400"],duration:7e3})})()}createBoard(){var e=this;return(0,l.Z)(function*(){return null==(yield e.apiService.sendHTTPRequest("boards","POST",e.activeBoard)).result?(e.notification.open("Failed to create board.","Close",{panelClass:["bg-red-400"],duration:7e3}),!1):(e.notification.open("Board created!.","Close",{panelClass:["bg-green-400"],duration:7e3}),!0)})()}createDefaultBoard(){this.allBoards.push(c),this.createBoard()}createBoardWithName(e){let o=Object.assign({},c);o.name=e,this.createBoard().then(s=>{s&&this.allBoards.unshift(o)})}checkIfBoardExists(e){return this.allBoards.find(o=>o.name==e)}}return t.\u0275fac=function(e){return new(e||t)(u.LFG(d.s),u.LFG(n.ux))},t.\u0275prov=u.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},5861:(p,h,i)=>{function l(u,d,n,a,t,r,e){try{var o=u[r](e),s=o.value}catch(f){return void n(f)}o.done?d(s):Promise.resolve(s).then(a,t)}function c(u){return function(){var d=this,n=arguments;return new Promise(function(a,t){var r=u.apply(d,n);function e(s){l(r,a,t,e,o,"next",s)}function o(s){l(r,a,t,e,o,"throw",s)}e(void 0)})}}i.d(h,{Z:()=>c})}}]);