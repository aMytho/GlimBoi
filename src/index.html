<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>GlimBoi</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--Compiled styles-->
    <link rel="stylesheet" href="output.css">
    <!-- jQuery library -->
    <script>window.$ = window.jQuery = require('jquery'); let dirName = __dirname
    </script>
    <!-- Popper JS -->
    <script src="../build/frontend/popper.js"></script>
    <!--Font Awesome -->
    <link href="css/icons/all.min.css" rel="stylesheet">
    <!--Datatables-->
    <link rel="stylesheet" href="css/dataTables.css">
    <script src="../build/frontend/dataTables/dataTables.js"></script>
    <!--Flowbite (modals, dropdowns, etc)-->
    <script src="../node_modules/flowbite/dist/flowbite.js"></script>

    <!--custom scripts-->
    <script src="../build/frontend/electronNav.js"></script>
    <script src="../build/frontend/home.js"></script>
    <script src="../build/frontend/users.js"></script>
    <script src="../build/frontend/ranks.js"></script>
    <script src="../build/frontend/commands.js"></script>
    <script src="../build/frontend/media.js"></script>
    <script src="../build/frontend/chat.js"></script>
    <script src="../build/frontend/events.js"></script>
    <script src="../build/frontend/music.js"></script>
    <script src="../build/frontend/modPanel.js"></script>
    <script src="../build/frontend/settings.js"></script>
</head>

<body>
    <div class="" style="width: 100%; background-color: #14193d;color:transparent;-webkit-app-region: drag">Have a nice
        day :)
        <i id="maximize" class="fa fa-window-maximize mx-1 mt-1"
            style="color: skyblue; float: right; -webkit-app-region: no-drag"></i>
        <i id="minimize" class="fa fa-window-minimize mx-1 mt-1"
            style="color: skyblue; float: right;-webkit-app-region: no-drag"></i>
        <i id="refresh" class="fas fa-sync mx-1 mt-1"
            style="color: skyblue; float: right; -webkit-app-region: no-drag"></i>
    </div>
    <!-- Tailwind nav -->
    <nav class="glimNav">
        <div class="pr-2 sm:pr-6 lg:pr-8">
            <div class="relative hidden lg:!flex items-center h-16" id="mainNavBar">
                <div class="hidden lg:!flex sm:visible flex-1 items-center justify-center sm:items-stretch sm:justify-start">
                    <div class="sm:block sm:ml-6">
                        <div class="flex space-x-4" id="navContainer">
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/commands.html" id="CommandLink">Commands</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/points.html" id="PointsLink">Points</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/events.html" id="EventsLink">Events</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/users.html" id="UsersLink">Users</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/ranks.html" id="RanksLink">Ranks</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/media.html" id="OBSLink">Media</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/music.html" id="MusicLink">Music Player</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/modPanel.html" id="ModPanelLink">Moderation</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/settings.html" id="SettingsLink">Integrations</a>
                            <a class="nav-link disabled text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium" href="../src/html/chat.html" id="ChatLink">Chat</a>
                            </div>
                    </div>
                </div>
                <div class="hidden xl:!flex items-center justify-center">
                    <a class="nav-link glimNavItem active font-bold text-xl" href="../src/html/homepage.html"style="color: turquoise;" id="GlimBoiHeader">GlimBoi</a>
                </div>
                <div class="hidden xl:!flex nav-item glimNavItem justify-center ml-8">
                    <div class="glimNavItem text whiteText group flex">
                        <a class="nav-link glimNavItem text whiteText items-center sm:hidden xl:inline-flex" href="#" style="color: #b2dbff;">Status
                            <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </a>
                        <!-- Status dropdown -->
                        <div class="cursor-default sm:hidden group-hover:flex ml-3 mt-8 absolute z-50" id="statusDropdown">
                            <div class="whiteText mt-2 w-48 rounded-md shadow-lg py-1 ring-1 ring-black ring-opacity-5 focus:outline-none mr-64"
                                aria-orientation="vertical" style="background-color: #14365b">
                                <a class="navbarAlt block px-4 py-2 text-sm" href="#">
                                    <p>Chat: <span id="navChatStatus" style="color:red">None</span></p>
                                </a>
                                <a class="navbarAlt block px-4 py-2 text-sm border-t-2 border-emerald-50 m-0" href="#">
                                    <p id="version"></p>
                                    <span class="badge badge-pill badge-success" style="position: relative;left: 20%;">Stable</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <a class="nav-link glimNavItem active text-gray-300 hover:text-red-400 py-2 rounded-md text-sm font-medium ml-4" href="#" id="close">Exit</a>
                </div>

            </div>
        </div>

    </nav>
    <!--End of Navbar-->


    <!-- Layout for home page -->
    <div class="pane h-100">
        <div class="card-body mt-3 mb-6 ml-3 mr-3 px-8 pb-8 rounded-xl glimPanel whiteText">

            <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <div>
                    <h4 class="text-2xl font-bold mt-3">Welcome to <span style="color:turquoise">GlimBoi</span></h4>
                    <p class="mt-6 text-xl">To get started select "Authorize." Log in with the account you want the bot to speak as. Glimboi
                        should request a token, but if you can't join a chat you should request one yourself.</p>
                    <p class="mt-6 text-xl">After that Glimboi will automatically request a token on startup. It may take 5-10 seconds to do
                        so. If you can't get something to work let me know!</p>
                    <p class="mt-6 text-xl">The bot may get disconnected, but it should rejoin after 5-10 seconds. You can toggle the message
                        on the chat page. It will look like nothing is happening, but it is reconnecting on the
                        background.</p>
                    <div class="flex flex-row flex-wrap gap-1 mt-4" >
                        <button class="btn-info grow" type="submit" id="authButton2" onclick="loadLink('glimboi.com/docs')">Documentation</button>
                        <button class="btn-info grow" type="submit" id="authButton3"
                            onclick="loadLink('github.com/aMytho/GlimBoi/blob/main/README.md')">Contributing</button>
                        <button class="btn-info grow" type="submit" id="authButton4"
                            onclick="loadLink('docs.google.com/forms/d/e/1FAIpQLScfCSuRgQwVqji0d5QKNUVIfQNiL64Q-dBEWseiXy0W_rSEcA/viewform?usp=sf_link')">Feedback</button>
                        <button class="btn-info grow" type="submit" id="authButton6"
                            onclick="loadLink('github.com/aMytho/GlimBoi/releases/latest')">Update Details</button>
                    </div>
                </div>
                <div>
                    <button class="btn-info mt-2 w-full" type="submit" id="saveAuth"
                        onclick="AuthHandle.requestUserAuthorization()">Authorize</button>
                    <button class="btn-info mt-2 w-full" type="submit" id="joinChannelBOT" disabled
                        onclick="AuthHandle.requestToken(true);">Request Token</button>
                    <div class="row mt-3">
                        <div class="col-12">
                            <div id="chart" class="mt-2">
                                <h3 class="text-center text-2xl font-bold">Bot Information</h3>
                                <table class="table whiteText mt-2 w-full border-collapse border-slate-200 bc rounded-xl " style="background-color: #14365b;">
                                    <thead>
                                        <tr>
                                            <th class="p-3 cyanBorder border-1 border-b-0 border-x-0 text-xl text-left" scope="col">Collection</th>
                                            <th class="p-3 cyanBorder border-1 border-b-0 border-x-0 text-xl text-left" scope="col">Count</th>
                                        </tr>
                                    </thead>
                                    <tbody style="color: aliceblue;">
                                        <tr>
                                            <td class="p-3 cyanBorder border-solid border-4 border-x-0 border-b-0">
                                                Commands
                                            </td>
                                            <td class="p-3 cyanBorder border-solid border-4 border-x-0 border-b-0">
                                                <span id="commandCount">0</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 cyanBorder border-solid border-1 border-x-0 border-b-0">
                                                Users
                                            </td>
                                            <td class="p-3 cyanBorder border-solid border-1 border-x-0 border-b-0">
                                                <span id="userCount">0</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 cyanBorder border-solid border-1 border-x-0 border-b-0">
                                                Points
                                            </td>
                                            <td class="p-3 cyanBorder border-solid border-1 border-x-0 border-b-0">
                                                <span id="pointCount">0</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 cyanBorder border-solid border-1 border-x-0 border-b-0">
                                                Quotes
                                            </td>
                                            <td class="p-3 cyanBorder border-solid border-1 border-x-0 border-b-0">
                                                <span id="quoteCount">0</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="notification" class="hidden glimPanel">
        <p id="message" class="whiteText"></p>
        <button id="close-button" onClick="closeNotification()" class="hidden btn btn-outline-primary">
            Close
        </button>
        <button id="restart-button" onClick="restartApp()" class="hidden btn btn-outline-success">
            Restart
        </button>
    </div>
    <style>
        #notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 200px;
            padding: 20px;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
        }

        .hidden {
            display: none;
        }
    </style>
    <script>
        //Creates the chart. Only build the first time. Also checks for updates
        async function startEverything() {
            checkForUpdate();
            loadBotStats();
            await startAuthProcess();
            unlockRequestToken();
        }
        startEverything();
    </script>
</body>

</html>



<!-- Modal: Error Message -->
<div class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 w-full md:inset-0 h-modal md:h-full"
    id="modalError" aria-hidden="true">
    <div class="w-3/12 h-1/4 relative max-w-md md:h-auto whiteText">
        <div class="rounded-lg shadow p-4 relative glimPanel whiteText">
            <!--Header-->
            <div class="text-center w-full border-solid border-b-2 border-blue-300 pb-2">
                <h4 id="myModalError" class="text-center whiteText font-bold text-2xl w-full">Error</h4>
            </div>
            <!--Body-->
            <div id="modalErrorBody" class="prose prose-base whiteText px-6 pb-4 mt-8">
                <p id="errorMessageText"></p>
                <p id="errorMessageSolution"></p>
            </div>
            <!--Footer-->
            <div class="flex justify-end relative bottom-0 mr-8 mt-8 w-full border-t-2 border-blue-300 border-solid py-2">
                <button type="button" class="btn-warning" id="closeErrorModal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal: Error Message -->

<!-- Modal: Success Message -->
<div class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 w-full md:inset-0 h-modal md:h-full"
     id="modalSuccess" tabindex="-1" aria-hidden="true" style="overflow-wrap: break-word;">
    <div class="relative max-w-xl h-full md:h-auto whiteText">
        <div class="rounded-lg shadow p-4 relative glimPanel whiteText">
            <!--Header-->
            <div class="text-center w-full border-solid border-b-2 border-blue-300 pb-2">
                <h4 class="text-center whiteText font-bold text-2xl w-full" id="myModalSuccess">Info</h4>
            </div>
            <!--Body-->
            <div class="prose prose-base whiteText px-6 pb-4 mt-8" id="modalSuccessBody">
                <p id="successMessageText"></p>
                <p id="successMessageSolution"></p>
            </div>
            <!--Footer-->
            <div class="flex justify-end relative bottom-0 mr-8 mt-8 w-full border-t-2 border-blue-300 border-solid py-2">
                <button type="button" class="btn-warning" id="closeSuccessModal">Close</button>
                <p id="otherMessageAdd"></p>
            </div>
        </div>
    </div>
</div>
<!-- Modal: Success Message -->

<!-- Modal: Reconnecting -->
<div class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 w-full md:inset-0 h-modal md:h-full"
    id="reconnectModal" tabindex="-1" aria-hidden="true" style="overflow-wrap: break-word;">
    <div class="relative max-w-xl h-full md:h-auto whiteText">
        <div class="rounded-lg shadow p-4 relative glimPanel whiteText">
            <!--Header-->
            <div class="text-center w-full border-solid border-b-2 border-blue-300 pb-2">
                <h4 class="text-center whiteText font-bold text-2xl w-full">Reconnecting</h4>
            </div>
            <!--Body-->
            <div class="prose prose-base whiteText px-6 pb-4 mt-8">
                <p id="chatMessageSolution">Attempting to reconnect in 5 seconds...</p>
            </div>
            <!--Footer-->
            <div class="modal-footer">
                <button type="button" class="btn-danger"
                    onclick="clearTimeout(reconnectDelay)">Cancel</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal: Reconnecting -->

<!--Toasts-->
<div aria-live="polite" aria-atomic="true">
    <!-- Position it -->
    <div id="toastContainer" class="flex flex-col gap-5 absolute right-5 bottom-5 z-50">

    </div>
</div>

<!--Music player (should move this later)-->
<audio id="musicAudio">
    <source src="#" type="audio/mp3">
    Your browser does not support the audio element.
</audio>
<!--Music player (should move this later)-->