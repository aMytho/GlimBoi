<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>GlimBoi</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="style.css">
        <!-- jQuery library -->
        <script>window.$ = window.jQuery = require('jquery'); let dirName = __dirname
        </script>
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <!-- Popper JS -->
        <script src="../build/frontend/popper.js"></script>
        <!-- Latest compiled JavaScript -->
        <script src="../build/frontend/bootstrap/bootstrap.min.js"></script>
        <link href="css/css/all.min.css" rel="stylesheet">
        <link rel="stylesheet" href="css/dataTables.css">
        <script src="../build/frontend/dataTables/dataTables.js"></script>
        <!--custom scripts-->
        <script src="../build/frontend/electronNav.js"></script>
        <script src="../build/frontend/home.js"></script>
        <script src="../build/frontend/html.js"></script>
        <script src="../build/frontend/users.js"></script>
        <script src="../build/frontend/ranks.js"></script>
        <script src="../build/frontend/commands.js"></script>
        <script src="../build/frontend/media.js"></script>
        <script src="../build/frontend/chat.js"></script>
        <script src="../build/frontend/events.js"></script>
        <script src="../build/frontend/music.js"></script>
        <script src="../build/frontend/modPanel.js"></script>
        <script src="../build/frontend/settings.js"></script>
    </head>
    <body>
        <div class="" style="width: 100%; background-color: #14193d;color:transparent;-webkit-app-region: drag">Have a nice day :)
            <i id="maximize" class="fa fa-window-maximize mx-1 mt-1" style="color: skyblue; float: right; -webkit-app-region: no-drag"></i>
            <i id="minimize" class="fa fa-window-minimize mx-1 mt-1" style="color: skyblue; float: right;-webkit-app-region: no-drag"></i>
            <i id="refresh" class="fas fa-sync mx-1 mt-1" style="color: skyblue; float: right; -webkit-app-region: no-drag"></i></div>
        <nav class="navbar navbar-expand-md navbar-dark glimNav" style="padding-bottom: 5px;" >

            <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
                <ul class="navbar-nav mr-auto" id="mainNavBar">
                    <li class="nav-item glimNavItem" id="Commands">
                        <a class="nav-link disabled" href="../src/html/commands.html" id="CommandLink">Commands</a>
                    </li>
                    <li class="nav-item glimNavItem" id="Quotes">
                        <a class="nav-link disabled" href="../src/html/points.html" id="PointsLink">Points</a>
                    </li>
                    <li class="nav-item glimNavItem" id="Events">
                        <a class="nav-link disabled" href="../src/html/newEvents.html" id="EventsLink">Events</a>
                    </li>
                    <li class="nav-item glimNavItem" id="DB">
                        <a class="nav-link disabled" href="../src/html/users.html" id="UsersLink">Users</a>
                    </li>
                    <li class="nav-item glimNavItem" id="Ranks">
                        <a class="nav-link disabled" href="../src/html/ranks.html" id="RanksLink">Ranks</a>
                    </li>
                    <li class="nav-item glimNavItem" id="OBS">
                        <a class="nav-link disabled" href="../src/html/media.html" id="OBSLink">Media</a>
                    </li>
                    <li class="nav-item glimNavItem" id="Music">
                        <a class="nav-link disabled" href="../src/html/music.html" id="MusicLink">Music Player</a>
                    </li>
                    <li class="nav-item glimNavItem" id="ModPanel">
                        <a class="nav-link disabled" href="../src/html/modPanel.html" id="ModPanelLink">Moderation</a>
                    </li>
                    <li class="nav-item glimNavItem" id="Settings">
                        <a class="nav-link disabled" href="../src/html/settings.html" id="SettingsLink">Integrations</a>
                    </li>
                    <li class="nav-item glimNavItem" id="Chat">
                        <a class="nav-link disabled" href="../src/html/chat.html" id="ChatLink">Chat</a>
                    </li>
                </ul>
            </div>
            <div class="mx-auto order-0">
                <a class="navbar-brand mx-auto nav-link glimNavItem active" href="../src/html/homepage.html" style="color: turquoise;" id="GlimBoiHeader">GlimBoi</a>
            </div>
            <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" style="color:#b2dbff">
                            Status
                        </a>
                        <div class="dropdown-menu mt-0" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item navbarAlt" href="#">
                                <p>Chat: <span id="navChatStatus" style="color:red">None</span></p>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item navbarAlt" href="#" style="margin: 0px;">
                                <p id="version"></p>
                                <span class="badge badge-pill badge-success" style="position: relative;left: 20%;">Production</span>
                            </a>
                        </div>
                    </li>
                    <li class="nav-item glimNavItem" id="musicNavIcon" style="display: none;">
                        <audio id="musicAudio">
                            <source src="#" type="audio/mp3">
                            Your browser does not support the audio element.
                          </audio>
                    </li>
                    <li class="nav-item glimNavItem">
                        <a class="nav-link" href="#" id="close">Exit</a>
                    </li>
                </ul>
            </div>
        </nav>
        <!--End of Navbar-->


        <!-- Layout for home page -->
        <div class="pane h-100">
            <div class="card-body mt-3 ml-3 mr-3 glimPanel whiteText">

                <div class="row">
                    <div class="col-md-6 col-12">
                        <div class="introaaa">
                            <h4>Welcome to <span style="color:turquoise">GlimBoi</span></h4>
                        </div>
                        <p>To get started select "Authorize." Log in with the account you want the bot to speak as. Glimboi should request a token, but if you can't join a chat you should request one yourself.</p>
                        <p>After that Glimboi will automatically request a token on startup. It may take 5-10 seconds to do so. If you can't get something to work let me know!</p>
                        <p>The bot may get disconnected, but it should rejoin after 5-10 seconds. You can toggle the message on the chat page. It will look like nothing is happening, but it is reconnecting on the background.</p>
                        <div class="row">
                            <div class="col">
                                <button class="btn btn-info btn-block" type="submit" id="authButton2" onclick="loadLink('glimboi.com/docs')">Documentation</button>
                            </div>
                            <div class="col">
                                <button class="btn btn-info btn-block" type="submit" id="authButton3" onclick="loadLink('github.com/aMytho/GlimBoi/blob/main/README.md')">Contributing</button>
                            </div>
                            <div class="col">
                                <button class="btn btn-info btn-block" type="submit" id="authButton4" onclick="loadLink('docs.google.com/forms/d/e/1FAIpQLScfCSuRgQwVqji0d5QKNUVIfQNiL64Q-dBEWseiXy0W_rSEcA/viewform?usp=sf_link')">Feedback</button>
                            </div>
                            <div class="col">
                                <button class="btn btn-info btn-block" type="submit" id="authButton6" onclick="loadLink('github.com/aMytho/GlimBoi/releases/latest')">Update Details</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-12">
                        <button class="btn btn-info btn-block mt-2" type="submit" id="saveAuth" onclick="AuthHandle.requestUserAuthorization()">Authorize</button>
                        <button class="btn btn-info btn-block" type="submit" id="joinChannelBOT" disabled onclick="AuthHandle.requestToken(true);">Request Token</button>
                        <div class="row mt-3">
                            <div class="col-12">
                                <div id="chart" class="mt-2">
                                    <h3 class="text-center">Bot Information</h3>
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th scope="col">Collection</th>
                                                <th scope="col">Count</th>
                                            </tr>
                                        </thead>
                                        <tbody style="color: aliceblue;">
                                            <tr>
                                                <td>
                                                    Commands
                                                </td>
                                                <td>
                                                    <span id="commandCount">0</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    Users
                                                </td>
                                                <td>
                                                    <span id="userCount">0</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    Points
                                                </td>
                                                <td>
                                                    <span id="pointCount">0</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    Quotes
                                                </td>
                                                <td>
                                                    <span id="quoteCount">0</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="notification" class="hidden glimPanel">
            <p id="message" class="whiteText"></p>
            <button id="close-button" onClick="closeNotification()" class="hidden btn btn-outline-primary">
                Close
            </button>
            <button id="restart-button" onClick="restartApp()" class="hidden btn btn-outline-success">
                Restart
            </button>
        </div>
        <style>
            #notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 200px;
            padding: 20px;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            }
            .hidden {
                display: none;
            }
        </style>
        <script>
            //Creates the chart. Only build the first time. Also checks for updates
            async function startEverything() {
                checkForUpdate();
                loadBotStats();
                await startAuthProcess();
                unlockRequestToken();
            }
            startEverything();
        </script>
    </body>
</html>


<!-- Modal: Error Message -->
<div class="modal fade" id="modalError" tabindex="-1" role="dialog" aria-labelledby="error modal" aria-hidden="true" style="overflow-wrap: break-word;">
    <div class="modal-dialog" role="document">
        <div class="modal-content glimPanel whiteText" id="errorModal">
            <!--Header-->
            <div class="modal-header text-center">
                <h4 class="modal-title w-100" id="myModalError">Error</h4>
            </div>
            <!--Body-->
            <div class="modal-body" id="modalErrorBody">
                <p id="errorMessageText"></p>
                <p id="errorMessageSolution"></p>
            </div>
            <!--Footer-->
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-warning" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal: Error Message -->

<!-- Modal: Success Message -->
<div class="modal fade" id="modalSuccess" tabindex="-1" role="dialog" aria-labelledby="success modal" aria-hidden="true" style="overflow-wrap: break-word;">
  	<div class="modal-dialog" role="document">
     	<div class="modal-content glimPanel whiteText" id="successModal">
        	<!--Header-->
        	<div class="modal-header text-center">
           		<h4 class="modal-title w-100" id="myModalSuccess">Info</h4>
        	</div>
        	<!--Body-->
        	<div class="modal-body" id="modalSuccessBody">
        		<p id="successMessageText"></p>
        		<p id="successMessageSolution"></p>
        	</div>
        	<!--Footer-->
        	<div class="modal-footer">
           		<p id="otherMessageAdd"></p>
           		<button type="button" class="btn btn-outline-warning" data-dismiss="modal">Close</button>
        	</div>
     	</div>
  	</div>
</div>
<!-- Modal: Success Message -->

<!-- Modal: Moderate? -->
<div class="modal fade" id="reconnectModal" tabindex="-1" role="dialog" aria-labelledby="chat modal" aria-hidden="true" style="overflow-wrap: break-word;">
    <div class="modal-dialog" role="document">
      <div class="modal-content glimPanel whiteText">
        <!--Header-->
        <div class="modal-header text-center">
          <h4 class="modal-title w-100">Reconnecting</h4>
        </div>
        <!--Body-->
        <div class="modal-body">
          <p id="chatMessageSolution" class="mt-2">Attempting to reconnect in 5 seconds...</p>
        </div>
        <!--Footer-->
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-danger" data-dismiss="modal" onclick="clearTimeout(reconnectDelay)">Cancel</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal: Moderate -->

<div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 200px;">
    <!-- Position it -->
    <div style="position: absolute; top: 0; right: 3%;">
        <!-- Then put toasts within -->
        <div class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="mr-auto">Glimboi</strong>
                <small class="text-muted"></small>
                <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="toast-body toast-danger" id="toastMessage">
                If you see this, something isn't right.
            </div>
        </div>
    </div>
</div>